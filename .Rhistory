rm(list = ls())
getwd()
getwd()
getwd()
# loading libraries
library(sp)
library(raster)
library(sf)
library(caret)
library(randomForest)
library (ggplot2)
library(mapview)
library(corrplot)
library(rpart)
library(rpart.plot)
library(sp)
library(gstat)
library(MASS)
library(gridExtra)
library(sp)
library(raster)
library(sf)
library(caret)
library(randomForest)
library (ggplot2)
library(mapview)
library(corrplot)
library(rpart)
library(rpart.plot)
library(sp)
library(gstat)
library(MASS)
library(gridExtra)
library(ggplot2)
library(mapview)
library(corrplot)
library(rpart)
library(rpart.plot)
library(sp)
library(gstat)
library(MASS)
library(gridExtra)
library(randomForest)
install.packages("mapview")
library(mapview)
library(raster)
library(sp)
library(raster)
covariates_RS <- raster::stack(list.files("./Covariates/", pattern="\\.tif$", full.names = TRUE))
names(covariates_RS)
covariates_RS <- raster::stack(list.files("./Covariates/", pattern="\\.tif$", full.names = FALSE))
names(covariates_RS)
covariates_RS <- raster::stack(list.files("./Covariates/", pattern="\\.tif$"))
covariates_RS <- raster::stack(list.files("./Covariates/", pattern="\\.tif$", full.names = FALSE))
covariates_RS <- raster::stack(list.files("./Covariates/", pattern="\\.tif$", full.names = TRUE))
names(covariates_RS)
names(covariates_RS)
files <- list.files("./Covariates/", pattern="\\.tif$", full.names = TRUE)
basename(files)
names(covariates_RS) <- c("Aspect", "Blue","Blue.tif", "Catchment_Area", "Channel_Network", "Elevation", "Green",
names(covariates_RS)
names(covariates_RS)
covariates_RS <- raster::stack(list.files("./Covariates/", pattern="\\.tif$", full.names = TRUE))
names(covariates_RS) <- c("Aspect", "Blue","Blue.tif", "Catchment_Area", "Channel_Network", "Elevation", "Green",
names(covariates_RS)
names(covariates_RS)
getwd()
# loading libraries
library(randomForest)
library(sp)
library(sf)
library(caret)
library(ggplot2)
library(mapview)
library(corrplot)
library(rpart)
library(rpart.plot)
library(sp)
library(gstat)
library(raster)
library(gridExtra)
library(randomForest)
# Covariablen reinladen --> zu einem Stack hochladen; funktioniert nur wenn gleicher Ausschnitt & gleiche Auflösung
covariates_RS <- raster::stack(list.files("./Covariates/", pattern="\\.tif$", full.names = TRUE))
names(covariates_RS)
names(covariates_RS) <- c("Aspect", "Blue","Blue.tif", "Catchment_Area", "Channel_Network", "Elevation", "Green",
"LS_Factor", "NDVI", "NIR", "Rainfall", "Red", "Slope", "SWIR1", "SWIR2", "Temperature",
"Valley_Depth", "Wetness_Index")
names(covariates_RS) <- c("Aspect", "Blue", "Catchment_Area", "Channel_Network", "Elevation", "Green",
"LS_Factor", "NDVI", "NIR", "Rainfall", "Red", "Slope", "SWIR1", "SWIR2", "Temperature",
"Valley_Depth", "Wetness_Index")
names(covariates_RS)
rm(list = ls())
covariates_RS <- raster::stack(list.files("./Covariates/", pattern="\\.tif$", full.names = TRUE))
names(covariates_RS) <- c("Aspect", "Blue", "Catchment_Area", "Channel_Network", "Elevation", "Green", "LS_Factor", "NDVI",
names(covariates_RS)
names(covariates_RS)
names(covariates_RS) <- c("Aspect", "Blue", "Catchment_Area", "Channel_Network", "Elevation", "Green", "LS_Factor", "NDVI",
"NIR", "Rainfall", "Red", "Slope", "SWIR1", "SWIR2", "Temperature", "Valley_Depth", "Wetness_Index")
names(covariates_RS)
# import shape file of point data
point = st_read("./GIS/points.shp")
# import shape file of Bavaria boundary
Bavaria = st_read("./GIS/boundary.shp")
# import shape file of Bavaria boundary
boundary = st_read("./GIS/boundary.shp")
plot(point, add =T, pch = 19)
# convert soil point data to spatial point data
coordinates(point) <- ~ x + y
# set projection
proj4string(point) <- CRS("+init=epsg:4326")
# import shape file of point data
point = st_read("./GIS/points.shp")
# set projection
proj4string(point) <- CRS("+init=epsg:4326")
# plot the point on the raster
plot(covariates$Nir, main = "Landsat Image + Sample Points")
# plot the point on the raster
plot(covariates_RS$Blue, main = "Landsat Image + Sample Points")
# plot the point on the raster
plot(covariates_RS$Blue, main = "Landsat Image + Sample Points")
plot(point, add =T, pch = 19)
# set projection
proj4string(point) <- CRS("+init=epsg:4326")
# convert soil point data to spatial point data
coordinates(point) <- ~ x + y
library(sf)
# convert soil point data to spatial point data
coordinates(point) <- ~ x + y
# set projection
proj4string(point) <- CRS("+init=epsg:4326")
#######################################################################
## Code - Model Testing 02: Dr. Ruhollah Taghizadeh
#######################################################################
# load library
library(sp)
library(raster)
library(sf)
library(caret)
library(randomForest)
library (ggplot2)
##############################################################################
# section 1: Digital Soil Mapping
# import Remote Sensing data
covariates_RS <- stack(list.files("./cov/", pattern="\\.tif$", full.names = TRUE))
names(covariates_RS)
# empty workspace
rm(list = ls())
# check directory
getwd()
# loading libraries
library(sp)
library(raster)
library(sf)
library(caret)
library(randomForest)
library (ggplot2)
# Covariablen laden und benennen (automatische Benennung hat bei mir iwie nicht geklappt)
covariates_RS <- raster::stack(list.files("./Covariates/", pattern="\\.tif$", full.names = TRUE))
names(covariates_RS)
names(covariates_RS) <- c("Aspect", "Blue", "Catchment_Area", "Channel_Network", "Elevation", "Green", "LS_Factor", "NDVI",
"NIR", "Rainfall", "Red", "Slope", "SWIR1", "SWIR2", "Temperature", "Valley_Depth", "Wetness_Index")
names(covariates_RS)
# import the point soil data from desktop --> X & Y koordinaten von shp-file an diese CSV anfügen
point <- read.csv ("soil.csv", header = TRUE)
# import shape file of point data
point = st_read("./GIS/points.shp")
boundary = st_read("./GIS/boundary.shp")
# set projection
proj4string(point) <- CRS("+init=epsg:4326")
# plot the point on the raster
plot(covariates_RS$Blue, main = "Boundary + Sample Points")
rm(list = ls())
# check directory
getwd()
# loading libraries
library(sp)
library(raster)
library(sf)
library(caret)
library(randomForest)
library (ggplot2)
########################### DATA PREPROCESSING ###############################
# Covariablen laden und benennen (automatische Benennung hat bei mir iwie nicht geklappt)
covariates_RS <- raster::stack(list.files("./Covariates/", pattern="\\.tif$", full.names = TRUE))
names(covariates_RS)
names(covariates_RS) <- c("Aspect", "Blue", "Catchment_Area", "Channel_Network", "Elevation", "Green", "LS_Factor", "NDVI",
names(covariates_RS)
names(covariates_RS)
names(covariates_RS)
# Covariablen laden und benennen (automatische Benennung hat bei mir iwie nicht geklappt)
covariates_RS <- raster::stack(list.files("./Covariates/", pattern="\\.tif$", full.names = TRUE))
names(covariates_RS) <- c("Aspect", "Blue", "Catchment_Area", "Channel_Network", "Elevation", "Green", "LS_Factor", "NDVI",
"NIR", "Rainfall", "Red", "Slope", "SWIR1", "SWIR2", "Temperature", "Valley_Depth", "Wetness_Index")
names(covariates_RS)
# import shape file of point data
point = st_read("./GIS/points.shp")
boundary = st_read("./GIS/boundary.shp")
crs(covariates_RS)
crs(point)
crs(covariates_RS)
crs(point)
crs(covariates_RS) <- "EPSG:4326"
crs(covariates_RS)
# import shape files of point data and boundary
point = st_read("./GIS/points.shp")
crs(point)
df_attr <- st_drop_geometry(point)
coords <- st_coordinates(point)
df <- cbind(df_attr,
df <- cbind(df_attr,
X = coords[, "X"],
Y = coords[, "Y"])
write.csv(df, "./GIS/punkte.csv", row.names = FALSE)
df_attr <- st_drop_geometry(point)
coords <- st_coordinates(point)
df <- cbind(df_attr,
X = coords[, "X"],
Y = coords[, "Y"])
write.csv(df, "./GIS/punkte.csv", row.names = FALSE)
dat <- read.csv("./GIS/punkte.csv", header = TRUE)
View(dat)
View(dat)
View(dat)
coordinates(dat) <- ~ x + y
coordinates(dat) <- ~ X + Y
View(dat)
View(dat)
proj4string(dat) <- CRS("+init=epsg:4326")
plot(dat, add =T, pch = 19)
plot(dat, pch = 19)
# plot the point on the raster
plot(covariates_RS$Blue, main = "Boundary + Sample Points")
plot(dat, add =T, pch = 19)
# import shape files of point data and boundary
point_shp = st_read("./GIS/points.shp")
df_attr <- st_drop_geometry(point_shp)
coords <- st_coordinates(point_shp)
df <- cbind(df_attr,x = coords[, "X"],y = coords[, "Y"])
write.csv(df, "./GIS/punkte.csv", row.names = FALSE)
points_csv <- read.csv("./GIS/punkte.csv", header = TRUE)
coordinates(points_csv) <- ~ x + y
coordinates(points_csv) <- ~ x + y
rm(list = ls())
# check directory
getwd()
# loading libraries
library(sp)
library(raster)
library(sf)
library(caret)
library(randomForest)
library (ggplot2)
# Covariablen laden und benennen (automatische Benennung hat bei mir iwie nicht geklappt)
covariates_RS <- raster::stack(list.files("./Covariates/", pattern="\\.tif$", full.names = TRUE))
names(covariates_RS) <- c("Aspect", "Blue", "Catchment_Area", "Channel_Network", "Elevation", "Green", "LS_Factor", "NDVI",
"NIR", "Rainfall", "Red", "Slope", "SWIR1", "SWIR2", "Temperature", "Valley_Depth", "Wetness_Index")
names(covariates_RS)
crs(covariates_RS) <- "EPSG:4326"
# import shape files of point data and boundary
point_shp = st_read("./GIS/points.shp")
df_attr <- st_drop_geometry(point_shp)
coords <- st_coordinates(point_shp)
df <- cbind(df_attr,x = coords[, "X"],y = coords[, "Y"])
write.csv(df, "./GIS/punkte.csv", row.names = FALSE)
points_csv <- read.csv("./GIS/punkte.csv", header = TRUE)
coordinates(points_csv) <- ~ x + y
proj4string(points_csv) <- CRS("+init=epsg:4326")
plot(dat, pch = 19)
plot(points_csv, pch = 19)
# import shape files of point data and boundary
point_shp = st_read("./GIS/points.shp")
df <- cbind(st_drop_geometry(point_shp), st_coordinates(point_shp))
write.csv(df, "./GIS/punkte.csv", row.names = FALSE)
points_csv <- st_read("./GIS/punkte.csv",
options = c("X_POSSIBLE_NAMES=x", "Y_POSSIBLE_NAMES=y"),
crs = 4326)
plot(points_csv, pch = 19)
# empty workspace
rm(list = ls())
# check directory
getwd()
# loading libraries
library(sp)
library(raster)
library(sf)
library(caret)
library(randomForest)
library (ggplot2)
# Covariablen laden und benennen (automatische Benennung hat bei mir iwie nicht geklappt)
covariates_RS <- raster::stack(list.files("./Covariates/", pattern="\\.tif$", full.names = TRUE))
names(covariates_RS) <- c("Aspect", "Blue", "Catchment_Area", "Channel_Network", "Elevation", "Green", "LS_Factor", "NDVI",
"NIR", "Rainfall", "Red", "Slope", "SWIR1", "SWIR2", "Temperature", "Valley_Depth", "Wetness_Index")
names(covariates_RS)
crs(covariates_RS) <- "EPSG:4326"
# import shape files of point data and boundary
point_shp = st_read("./GIS/points.shp")
df <- cbind(st_drop_geometry(point_shp), st_coordinates(point_shp))
write.csv(df, "./GIS/punkte.csv", row.names = FALSE)
points_csv <- read.csv("./GIS/punkte.csv", header = TRUE)
coordinates(points_csv) <- ~ x + y
coordinates(points_csv) <- ~ X + Y
proj4string(points_csv) <- CRS("+init=epsg:4326")
plot(points_csv, pch = 19)
# empty workspace
rm(list = ls())
covariates_RS <- raster::stack(list.files("./Covariates/", pattern="\\.tif$", full.names = TRUE))
names(covariates_RS) <- c("Aspect", "Blue", "Catchment_Area", "Channel_Network", "Elevation", "Green", "LS_Factor", "NDVI",
"NIR", "Rainfall", "Red", "Slope", "SWIR1", "SWIR2", "Temperature", "Valley_Depth", "Wetness_Index")
names(covariates_RS)
crs(covariates_RS) <- "EPSG:4326"
# import the point soil data from desktop --> X & Y koordinaten von shp-file an diese CSV anfügen
# import shape files of point data and boundary
point_shp = st_read("./GIS/points.shp")
df <- cbind(st_drop_geometry(point_shp), st_coordinates(point_shp))
write.csv(df, "./GIS/punkte.csv", row.names = FALSE)
View(df)
points_csv <- read.csv("./GIS/punkte.csv", header = TRUE)
View(points_csv)
coordinates(points_csv) <- ~ X + Y
proj4string(points_csv) <- CRS("+init=epsg:4326")
View(points_csv)
plot(points_csv, pch = 19)
# Covariablen laden und benennen (automatische Benennung hat bei mir iwie nicht geklappt)
covariates_RS <- stack(list.files("./Covariates/", pattern="\\.tif$", full.names = TRUE))
names(covariates_RS) <- c("Aspect", "Blue", "Catchment_Area", "Channel_Network", "Elevation", "Green", "LS_Factor", "NDVI",
"NIR", "Rainfall", "Red", "Slope", "SWIR1", "SWIR2", "Temperature", "Valley_Depth", "Wetness_Index")
names(covariates_RS)
crs(covariates_RS) <- "EPSG:4326"
head(points_csv)
boundary = st_read("./GIS/boundary.shp")
plot(boundary)
plot(study_area)
study_area_sf <- st_read("./GIS/boundary.shp")
study_area    <- as(study_area_sf, "Spatial")
plot(study_area)
study_area <- as(st_read("./GIS/boundary.shp"), "Spatial")
plot(study_area)
plot(points_csv, add =T, pch = 19)
View(points_csv)
# Import der .csv SOIL Daten & Umwandlung in räumliche Daten (Koordinaten + Koordinatensystem)
soil_csv <- read.csv("./Soil/soil.csv", header = TRUE)
coordinates(soil_csv) <- ~ x + y
proj4string(soil_csv) <- CRS("+init=epsg:4326")
head(soil_csv)
plot(soil_csv, add =T, pch = 18)
plot(soil_csv, add =T, pch = 18, col ="red")
# empty workspace
rm(list = ls())
# check directory
getwd()
# loading libraries
library(sp)
library(raster)
library(sf)
library(caret)
library(randomForest)
library (ggplot2)
# Kovariablen laden, benennen (automatische Benennung hat nicht geklappt) & Koordinatensystem zuweisen
covariates_RS <- stack(list.files("./Covariates/", pattern="\\.tif$", full.names = TRUE))
names(covariates_RS) <- c("Aspect", "Blue", "Catchment_Area", "Channel_Network", "Elevation", "Green", "LS_Factor", "NDVI",
"NIR", "Rainfall", "Red", "Slope", "SWIR1", "SWIR2", "Temperature", "Valley_Depth", "Wetness_Index")
crs(covariates_RS) <- "EPSG:4326"
# Import der .csv SOIL Daten & Umwandlung in räumliche Daten (Koordinaten + Koordinatensystem)
soil_csv <- read.csv("./Soil/soil.csv", header = TRUE)
coordinates(soil_csv) <- ~ x + y
proj4string(soil_csv) <- CRS("+init=epsg:4326")
head(soil_csv)
plot(soil_csv, add =T, pch = 18, col ="red")
# Import der Grenzen des Untersuchungsgebiets
study_area <- as(st_read("./GIS/boundary.shp"), "Spatial")
plot(study_area)
plot(soil_csv, add =T, pch = 18, col ="red")
View(soil_csv)
View(covariates_RS)
# extract covariate values at each point of observation
cov = extract(covariates_RS, soil_csv, method='bilinear', df=TRUE)
View(cov)
View(soil_csv)
# combining covariates and soil properties
cov_soil = cbind(cov[,-1], CEC=soil_csv$CEC)
View(cov_soil)
# remove na values
cov_soil <- cov_soil[complete.cases(cov_soil),]
str(cov_soil)
# empty workspace
rm(list = ls())
# check directory
getwd()
# loading libraries
library(sp)
library(raster)
library(sf)
library(caret)
library(randomForest)
library (ggplot2)
# Kovariablen laden, benennen (automatische Benennung hat nicht geklappt) & Koordinatensystem zuweisen
covariates_RS <- stack(list.files("./Covariates/", pattern="\\.tif$", full.names = TRUE))
names(covariates_RS) <- c("Aspect", "Blue", "Catchment_Area", "Channel_Network", "Elevation", "Green", "LS_Factor", "NDVI",
"NIR", "Rainfall", "Red", "Slope", "SWIR1", "SWIR2", "Temperature", "Valley_Depth", "Wetness_Index")
crs(covariates_RS) <- "EPSG:4326"
# Import der .csv SOIL Daten & Umwandlung in räumliche Daten (Koordinaten + Koordinatensystem)
soil_csv <- read.csv("./Soil/soil.csv", header = TRUE)
coordinates(soil_csv) <- ~ x + y
proj4string(soil_csv) <- CRS("+init=epsg:4326")
head(soil_csv)
# Import der Grenzen des Untersuchungsgebiets
study_area <- as(st_read("./GIS/boundary.shp"), "Spatial")
plot(study_area)
# Import der .csv SOIL Daten & Umwandlung in räumliche Daten (Koordinaten + Koordinatensystem)
soil_csv <- read.csv("./Soil/soil.csv", header = TRUE)
coordinates(soil_csv) <- ~ x + y
proj4string(soil_csv) <- CRS("+init=epsg:4326")
head(soil_csv)
plot(soil_csv, add =T, pch = 18, col ="red")
# Extraktion der Kovariaten an den Messpunkten
cov = extract(covariates_RS, soil_csv, method='bilinear', df=TRUE)
# Kombination der Kovariate mit der CEC (Zielvariable)
cov_soil = cbind(cov[,-1], CEC=soil_csv$CEC)
str(cov_soil)
View(cov_soil)
plot(study_area, head = "Untersuchungsgebiet")
plot(study_area, main = "Untersuchungsgebiet")
plot(soil_csv, add =T, pch = 18, col ="red")
str(cov_soil)
# empty workspace
rm(list = ls())
# check directory
getwd()
# loading libraries
library(sp)
library(raster)
library(sf)
library(caret)
library(randomForest)
library (ggplot2)
# Kovariablen laden, benennen (automatische Benennung hat nicht geklappt) & Koordinatensystem zuweisen
covariates_RS <- stack(list.files("./Covariates/", pattern="\\.tif$", full.names = TRUE))
names(covariates_RS) <- c("Aspect", "Blue", "Catchment_Area", "Channel_Network", "Elevation", "Green", "LS_Factor", "NDVI",
"NIR", "Rainfall", "Red", "Slope", "SWIR1", "SWIR2", "Temperature", "Valley_Depth", "Wetness_Index")
crs(covariates_RS) <- "EPSG:4326"
# Import der Grenzen des Untersuchungsgebiets
study_area <- as(st_read("./GIS/boundary.shp"), "Spatial")
plot(study_area, main = "Untersuchungsgebiet")
# Import der .csv SOIL Daten & Umwandlung in räumliche Daten (Koordinaten + Koordinatensystem)
soil_csv <- read.csv("./Soil/soil.csv", header = TRUE)
coordinates(soil_csv) <- ~ x + y
proj4string(soil_csv) <- CRS("+init=epsg:4326")
head(soil_csv)
plot(soil_csv, add =T, pch = 18, col ="red")
# Extraktion der Kovariaten an den Messpunkten
cov = extract(covariates_RS, soil_csv, method='bilinear', df=TRUE)
# Kombination der Kovariate mit der CEC (Zielvariable)
cov_soil = cbind(cov[,-1], CEC=soil_csv$CEC)
