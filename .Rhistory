# variable importance
importance(rf_fit)
varImpPlot(rf_fit, main = "Variable Importance for RF model")
rf_fit <- randomForest(CEC ~ Aspect+Catchment_Area+Channel_Network+Elevation+Temprature+LS_Factor+NDVI+NIR+Rainfall+Slope+SWIR1+Wetness_Index,
data = cov_soil_Train, ntree = 5000, do.trace = 400, maxnodes = 40) #Cor: 2.1
summary(rf_fit)
# variable importance
importance(rf_fit)
varImpPlot(rf_fit, main = "Variable Importance for RF model")
CEC_rf_Pred <- predict(rf_fit, cov_soil_Test)
# check the plot actual and predicted OC values
plot(cov_soil_Test$CEC, CEC_rf_Pred, main="Tree model",
col="blue",xlab="Actual CEC", ylab="Predicted CEC", xlim=c(0,100),ylim=c(0,100))
abline(coef = c(0,1),  col="red" )
# calculate correlation
cor_rf <- cor(cov_soil_Test$CEC, CEC_rf_Pred)
cor_rf
# variable importance
importance(rf_fit)
varImpPlot(rf_fit, main = "Variable Importance for RF model")
rf_fit <- randomForest(CEC ~ Aspect+Catchment_Area+Channel_Network+Elevation+Temprature+LS_Factor+NDVI+NIR+Rainfall+Slope+SWIR1+Wetness_Index,
data = cov_soil_Train, ntree = 5000, do.trace = 400, maxnodes = 80) #Cor: 2.1
summary(rf_fit)
# variable importance
importance(rf_fit)
varImpPlot(rf_fit, main = "Variable Importance for RF model")
CEC_rf_Pred <- predict(rf_fit, cov_soil_Test)
# check the plot actual and predicted OC values
plot(cov_soil_Test$CEC, CEC_rf_Pred, main="Tree model",
col="blue",xlab="Actual CEC", ylab="Predicted CEC", xlim=c(0,100),ylim=c(0,100))
abline(coef = c(0,1),  col="red" )
# calculate correlation
cor_rf <- cor(cov_soil_Test$CEC, CEC_rf_Pred)
cor_rf
rf_fit <- randomForest(CEC ~ Aspect+Channel_Network+Elevation+Temprature+LS_Factor+NDVI+NIR+Rainfall+Slope+SWIR1+Wetness_Index,
data = cov_soil_Train, ntree = 5000, do.trace = 400, maxnodes = 80) #Cor: 2.1
summary(rf_fit)
# variable importance
importance(rf_fit)
varImpPlot(rf_fit, main = "Variable Importance for RF model")
CEC_rf_Pred <- predict(rf_fit, cov_soil_Test)
# check the plot actual and predicted OC values
plot(cov_soil_Test$CEC, CEC_rf_Pred, main="Tree model",
col="blue",xlab="Actual CEC", ylab="Predicted CEC", xlim=c(0,100),ylim=c(0,100))
abline(coef = c(0,1),  col="red" )
# calculate correlation
cor_rf <- cor(cov_soil_Test$CEC, CEC_rf_Pred)
cor_rf
varImpPlot(rf_fit, main = "Variable Importance for RF model")
rf_fit <- randomForest(CEC ~ Aspect+Catchment_Area+Channel_Network+Elevation+Temprature+LS_Factor+NDVI+NIR+Rainfall+SWIR1+Wetness_Index,
data = cov_soil_Train, ntree = 5000, do.trace = 400, maxnodes = 80) #Cor: 2.1
summary(rf_fit)
# variable importance
importance(rf_fit)
varImpPlot(rf_fit, main = "Variable Importance for RF model")
CEC_rf_Pred <- predict(rf_fit, cov_soil_Test)
# check the plot actual and predicted OC values
plot(cov_soil_Test$CEC, CEC_rf_Pred, main="Tree model",
col="blue",xlab="Actual CEC", ylab="Predicted CEC", xlim=c(0,100),ylim=c(0,100))
abline(coef = c(0,1),  col="red" )
# calculate correlation
cor_rf <- cor(cov_soil_Test$CEC, CEC_rf_Pred)
cor_rf
rf_fit <- randomForest(CEC ~ Aspect+Catchment_Area+Channel_Network+Elevation+Green+Temprature+LS_Factor+NDVI+NIR+Rainfall+Slope+SWIR1+Wetness_Index,
data = cov_soil_Train, ntree = 10000, do.trace = 400) #Cor: 2.1
summary(rf_fit)
# variable importance
importance(rf_fit)
varImpPlot(rf_fit, main = "Variable Importance for RF model")
CEC_rf_Pred <- predict(rf_fit, cov_soil_Test)
# check the plot actual and predicted OC values
plot(cov_soil_Test$CEC, CEC_rf_Pred, main="Tree model",
col="blue",xlab="Actual CEC", ylab="Predicted CEC", xlim=c(0,100),ylim=c(0,100))
abline(coef = c(0,1),  col="red" )
# calculate correlation
cor_rf <- cor(cov_soil_Test$CEC, CEC_rf_Pred)
cor_rf
rf_fit <- randomForest(CEC ~ Aspect+Catchment_Area+Channel_Network+Elevation+Green+Temprature+LS_Factor+NDVI+NIR+Rainfall+Slope+SWIR1+Wetness_Index,
data = cov_soil_Train, ntree = 10000, do.trace = 400, maxnodes = 15) #Cor: 2.1
summary(rf_fit)
# variable importance
importance(rf_fit)
varImpPlot(rf_fit, main = "Variable Importance for RF model")
CEC_rf_Pred <- predict(rf_fit, cov_soil_Test)
# check the plot actual and predicted OC values
plot(cov_soil_Test$CEC, CEC_rf_Pred, main="Tree model",
col="blue",xlab="Actual CEC", ylab="Predicted CEC", xlim=c(0,100),ylim=c(0,100))
abline(coef = c(0,1),  col="red" )
# calculate correlation
cor_rf <- cor(cov_soil_Test$CEC, CEC_rf_Pred)
cor_rf
rf_fit <- randomForest(CEC ~ Aspect+Catchment_Area+Channel_Network+Elevation+Green+Temprature+LS_Factor+NDVI+NIR+Rainfall+Slope+SWIR1+Wetness_Index,
data = cov_soil_Train, ntree = 10000, do.trace = 400, maxnodes = 40) #Cor: 2.1
summary(rf_fit)
# variable importance
importance(rf_fit)
varImpPlot(rf_fit, main = "Variable Importance for RF model")
CEC_rf_Pred <- predict(rf_fit, cov_soil_Test)
# check the plot actual and predicted OC values
plot(cov_soil_Test$CEC, CEC_rf_Pred, main="Tree model",
col="blue",xlab="Actual CEC", ylab="Predicted CEC", xlim=c(0,100),ylim=c(0,100))
abline(coef = c(0,1),  col="red" )
# calculate correlation
cor_rf <- cor(cov_soil_Test$CEC, CEC_rf_Pred)
cor_rf
# rf performance
RMSE_RF <- sqrt(mean((cov_soil_Test$CEC - CEC_rf_Pred)^2))
RMSE_RF
MAE_RF <- mean(abs(cov_soil_Test$CEC - CEC_rf_Pred))
rf_fit <- randomForest(CEC ~ Aspect+Catchment_Area+Channel_Network+Elevation+Green+Temprature+LS_Factor+NDVI+NIR+Rainfall+Slope+SWIR1+Wetness_Index,
data = cov_soil_Train, ntree = 10000, maxnodes = 40) #Cor: 2.1
summary(rf_fit)
# variable importance
importance(rf_fit)
varImpPlot(rf_fit, main = "Variable Importance for RF model")
CEC_rf_Pred <- predict(rf_fit, cov_soil_Test)
# check the plot actual and predicted OC values
plot(cov_soil_Test$CEC, CEC_rf_Pred, main="Tree model",
col="blue",xlab="Actual CEC", ylab="Predicted CEC", xlim=c(0,100),ylim=c(0,100))
abline(coef = c(0,1),  col="red" )
# calculate correlation
cor_rf <- cor(cov_soil_Test$CEC, CEC_rf_Pred)
cor_rf
# inspect the two datasets
str(cov_soil_Train)
varImpPlot(rf_fit, main = "Variable Importance for RF model")
# check the plot actual and predicted OC values
plot(cov_soil_Test$CEC, CEC_rf_Pred, main="Tree model",
col="blue",xlab="Actual CEC", ylab="Predicted CEC", xlim=c(0,100),ylim=c(0,100))
abline(coef = c(0,1),  col="red" )
rf_fit <- randomForest(CEC ~ Aspect+Catchment_Area+Channel_Network+Elevation+Green+Temprature+LS_Factor+NDVI+NIR+Rainfall+Slope+SWIR1+Wetness_Index,
data = cov_soil_Train, ntree = 10000, do.trace = 400) #Cor: 2.1
summary(rf_fit)
# variable importance
importance(rf_fit)
varImpPlot(rf_fit, main = "Variable Importance for RF model")
CEC_rf_Pred <- predict(rf_fit, cov_soil_Test)
# check the plot actual and predicted OC values
plot(cov_soil_Test$CEC, CEC_rf_Pred, main="Tree model",
col="blue",xlab="Actual CEC", ylab="Predicted CEC", xlim=c(0,100),ylim=c(0,100))
abline(coef = c(0,1),  col="red" )
# calculate correlation
cor_rf <- cor(cov_soil_Test$CEC, CEC_rf_Pred)
cor_rf
rf_fit <- randomForest(CEC ~ Aspect+Catchment_Area+Channel_Network+Green+Temprature+LS_Factor+NDVI+NIR+Rainfall+Slope+SWIR1+Wetness_Index,
data = cov_soil_Train, ntree = 10000, do.trace = 400) #Cor: 2.1
summary(rf_fit)
# variable importance
importance(rf_fit)
varImpPlot(rf_fit, main = "Variable Importance for RF model")
CEC_rf_Pred <- predict(rf_fit, cov_soil_Test)
# check the plot actual and predicted OC values
plot(cov_soil_Test$CEC, CEC_rf_Pred, main="Tree model",
col="blue",xlab="Actual CEC", ylab="Predicted CEC", xlim=c(0,100),ylim=c(0,100))
abline(coef = c(0,1),  col="red" )
# calculate correlation
cor_rf <- cor(cov_soil_Test$CEC, CEC_rf_Pred)
cor_rf
rf_fit <- randomForest(CEC ~ Aspect+Catchment_Area+Temprature+NDVI+NIR+Rainfall+Slope+SWIR1+Wetness_Index,
data = cov_soil_Train, ntree = 10000, do.trace = 400) #Cor: 2.1
summary(rf_fit)
# variable importance
importance(rf_fit)
varImpPlot(rf_fit, main = "Variable Importance for RF model")
CEC_rf_Pred <- predict(rf_fit, cov_soil_Test)
# check the plot actual and predicted OC values
plot(cov_soil_Test$CEC, CEC_rf_Pred, main="Tree model",
col="blue",xlab="Actual CEC", ylab="Predicted CEC", xlim=c(0,100),ylim=c(0,100))
abline(coef = c(0,1),  col="red" )
# calculate correlation
cor_rf <- cor(cov_soil_Test$CEC, CEC_rf_Pred)
cor_rf
cor_matrix <- cor(cov_soil_Train[,c("Aspect","Catchment_Area","Channel_Network",
"Green","Temprature","LS_Factor","NDVI",
"NIR","Rainfall","Slope","SWIR1","Wetness_Index")],
use="complete.obs")
# Hohe Korrelationen finden (>0.7)
high_corr <- which(abs(cor_matrix) > 0.7 & abs(cor_matrix) < 1, arr.ind=TRUE)
print(cor_matrix[high_corr])
library(car)
mod <- lm(CEC ~ Aspect+Catchment_Area+Channel_Network+Green+Temprature+LS_Factor+
NDVI+NIR+Rainfall+Slope+SWIR1+Wetness_Index, data=cov_soil_Train)
vif(mod)
mod <- lm(CEC ~ Aspect+Catchment_Area+Channel_Network+Temprature+LS_Factor+
NDVI+NIR+Rainfall+Slope+SWIR1+Wetness_Index, data=cov_soil_Train)
vif(mod)
mod <- lm(CEC ~ Aspect+Catchment_Area+Channel_Network+Temprature+LS_Factor+
NDVI+NIR+Rainfall+SWIR1+Wetness_Index, data=cov_soil_Train)
vif(mod)
mod <- lm(CEC ~ Aspect+Catchment_Area+Channel_Network+Temprature+LS_Factor+
NDVI+NIR+Rainfall+Wetness_Index, data=cov_soil_Train)
vif(mod)
rf_fit <- randomForest(CEC ~ Aspect+Catchment_Area+Channel_Network+Temprature+LS_Factor+NDVI+NIR+Rainfall+Wetness_Index,
data = cov_soil_Train, ntree = 10000, do.trace = 400) #Cor: 2.1
summary(rf_fit)
# variable importance
importance(rf_fit)
varImpPlot(rf_fit, main = "Variable Importance for RF model")
CEC_rf_Pred <- predict(rf_fit, cov_soil_Test)
# check the plot actual and predicted OC values
plot(cov_soil_Test$CEC, CEC_rf_Pred, main="Tree model",
col="blue",xlab="Actual CEC", ylab="Predicted CEC", xlim=c(0,100),ylim=c(0,100))
abline(coef = c(0,1),  col="red" )
# calculate correlation
cor_rf <- cor(cov_soil_Test$CEC, CEC_rf_Pred)
cor_rf
mod <- lm(CEC ~ Aspect+Catchment_Area+Channel_Network+Temprature+LS_Factor+NDVI+NIR+Rainfall+Wetness_Index, data=cov_soil_Train)
vif(mod)
mod <- lm(CEC ~ Aspect+Catchment_Area+Channel_Network++Elevation+Temprature+LS_Factor+NDVI+NIR+Rainfall+Wetness_Index, data=cov_soil_Train)
vif(mod)
mod <- lm(CEC ~ Aspect+Catchment_Area+Channel_Network+Green+Temprature+LS_Factor+
+ NDVI+NIR+Rainfall+Slope+SWIR1+Wetness_Index, data=cov_soil_Train)
vif(mod)
mod <- lm(CEC ~ Aspect+Catchment_Area+Channel_Network+Green+Temprature+LS_Factor+
+ NDVI+Rainfall+Wetness_Index, data=cov_soil_Train)
vif(mod)
mod <- lm(CEC ~ Aspect+Catchment_Area+Channel_Network+Temprature+LS_Factor+
+ NDVI+Rainfall+Wetness_Index, data=cov_soil_Train)
vif(mod)
rf_fit <- randomForest(CEC ~ Aspect+Catchment_Area+Channel_Network+Temprature+LS_Factor+NDVI+Rainfall+Wetness_Index,
data = cov_soil_Train, ntree = 10000, do.trace = 400) #Cor: 2.1
summary(rf_fit)
# variable importance
importance(rf_fit)
varImpPlot(rf_fit, main = "Variable Importance for RF model")
CEC_rf_Pred <- predict(rf_fit, cov_soil_Test)
# check the plot actual and predicted OC values
plot(cov_soil_Test$CEC, CEC_rf_Pred, main="Tree model",
col="blue",xlab="Actual CEC", ylab="Predicted CEC", xlim=c(0,100),ylim=c(0,100))
abline(coef = c(0,1),  col="red" )
# calculate correlation
cor_rf <- cor(cov_soil_Test$CEC, CEC_rf_Pred)
cor_rf
rf_fit <- randomForest(CEC ~ Aspect+Catchment_Area+Channel_Network+Elevation+Green+Temprature+LS_Factor+NDVI+NIR+Rainfall+Slope+SWIR1+Wetness_Index,
data = cov_soil_Train, ntree = 10000, do.trace = 400) #Cor: 2.1
summary(rf_fit)
# variable importance
importance(rf_fit)
varImpPlot(rf_fit, main = "Variable Importance for RF model")
CEC_rf_Pred <- predict(rf_fit, cov_soil_Test)
# check the plot actual and predicted OC values
plot(cov_soil_Test$CEC, CEC_rf_Pred, main="Tree model",
col="blue",xlab="Actual CEC", ylab="Predicted CEC", xlim=c(0,100),ylim=c(0,100))
abline(coef = c(0,1),  col="red" )
# calculate correlation
cor_rf <- cor(cov_soil_Test$CEC, CEC_rf_Pred)
cor_rf
rf_fit <- randomForest(CEC ~ Aspect+Catchment_Area+Channel_Network+Elevation+Green+Temprature+LS_Factor+NDVI+NIR+Rainfall+Slope+SWIR1+Wetness_Index,
data = cov_soil_Train, ntree = 10000, do.trace = 400, maxnodes = 10) #Cor: 2.1
summary(rf_fit)
# variable importance
importance(rf_fit)
varImpPlot(rf_fit, main = "Variable Importance for RF model")
CEC_rf_Pred <- predict(rf_fit, cov_soil_Test)
# check the plot actual and predicted OC values
plot(cov_soil_Test$CEC, CEC_rf_Pred, main="Tree model",
col="blue",xlab="Actual CEC", ylab="Predicted CEC", xlim=c(0,100),ylim=c(0,100))
abline(coef = c(0,1),  col="red" )
# calculate correlation
cor_rf <- cor(cov_soil_Test$CEC, CEC_rf_Pred)
cor_rf
rf_fit <- randomForest(CEC ~ Aspect+Catchment_Area+Channel_Network+Elevation+Green+Temprature+LS_Factor+NDVI+NIR+Rainfall+Slope+SWIR1+Wetness_Index,
data = cov_soil_Train, ntree = 10000, maxnodes = 5) #Cor: 2.1
summary(rf_fit)
# variable importance
importance(rf_fit)
varImpPlot(rf_fit, main = "Variable Importance for RF model")
CEC_rf_Pred <- predict(rf_fit, cov_soil_Test)
# check the plot actual and predicted OC values
plot(cov_soil_Test$CEC, CEC_rf_Pred, main="Tree model",
col="blue",xlab="Actual CEC", ylab="Predicted CEC", xlim=c(0,100),ylim=c(0,100))
abline(coef = c(0,1),  col="red" )
# calculate correlation
cor_rf <- cor(cov_soil_Test$CEC, CEC_rf_Pred)
cor_rf
# subset the datasets
cov_soil_Train <- cov_soil[ trainIndex,]
rf_fit <- randomForest(CEC ~ Aspect+Catchment_Area+Channel_Network+Elevation+Green+Temprature+LS_Factor+NDVI+NIR+Rainfall+Slope+SWIR1+Wetness_Index,
data = cov_soil_Train, ntree = 10000) #Cor: 2.1
summary(rf_fit)
# variable importance
importance(rf_fit)
varImpPlot(rf_fit, main = "Variable Importance for RF model")
CEC_rf_Pred <- predict(rf_fit, cov_soil_Test)
# check the plot actual and predicted OC values
plot(cov_soil_Test$CEC, CEC_rf_Pred, main="Tree model",
col="blue",xlab="Actual CEC", ylab="Predicted CEC", xlim=c(0,100),ylim=c(0,100))
abline(coef = c(0,1),  col="red" )
# calculate correlation
cor_rf <- cor(cov_soil_Test$CEC, CEC_rf_Pred)
cor_rf
# rf performance
RMSE_RF <- sqrt(mean((cov_soil_Test$CEC - CEC_rf_Pred)^2))
RMSE_RF
MAE_RF <- mean(abs(cov_soil_Test$CEC - CEC_rf_Pred))
MAE_RF
R2_RF <- 1 - sum((cov_soil_Test$CEC - CEC_rf_Pred)^2)/sum((cov_soil_Test$CEC - mean(cov_soil_Test$CEC))^2)
R2_RF
# fit random forest model
rf_fit <- randomForest(CEC ~ Aspect+Blue+Catchment_Area+Channel_Network+Elevation+Green+LS_Factor+NDVI+NIR+Rainfall+Red+Slope+SWIR1+SWIR2+Temprature+Valley_Depth+Wetness_Index,
data = cov_soil_Train, ntree = 1000, do.trace = 50) #Cor: 1.7
CEC_rf_Pred <- predict(rf_fit, cov_soil_Test)
R2_RF <- 1 - sum((cov_soil_Test$CEC - CEC_rf_Pred)^2)/sum((cov_soil_Test$CEC - mean(cov_soil_Test$CEC))^2)
R2_RF
rf_fit <- randomForest(CEC ~ Aspect+Catchment_Area+Channel_Network+Elevation+Temprature+LS_Factor+NDVI+NIR+Rainfall+Slope+SWIR1+Wetness_Index,
data = cov_soil_Train, ntree = 10000) #Cor: 2.1
CEC_rf_Pred <- predict(rf_fit, cov_soil_Test)
R2_RF <- 1 - sum((cov_soil_Test$CEC - CEC_rf_Pred)^2)/sum((cov_soil_Test$CEC - mean(cov_soil_Test$CEC))^2)
R2_RF
rf_fit <- randomForest(CEC ~ Aspect+Catchment_Area+Channel_Network+Elevation+Temprature+LS_Factor+NDVI+NIR+Rainfall+Slope+SWIR1+Wetness_Index,
data = cov_soil_Train, ntree = 10000, maxnodes = 12) #Cor: 2.1
CEC_rf_Pred <- predict(rf_fit, cov_soil_Test)
R2_RF <- 1 - sum((cov_soil_Test$CEC - CEC_rf_Pred)^2)/sum((cov_soil_Test$CEC - mean(cov_soil_Test$CEC))^2)
R2_RF
pring(rf_fit)
print(rf_fit)
rf_fit <- randomForest(CEC ~ Aspect+Catchment_Area+Channel_Network+Elevation+Green+Temprature+LS_Factor+NDVI+NIR+Rainfall+Slope+SWIR1+Wetness_Index,
data = cov_soil_Train, ntree = 10000) #Cor: 2.1
summary(rf_fit)
print(rf_fit)
library(car)
mod <- lm(CEC ~ ., data=cov_soil_Train)
vif(mod)
mod <- lm(CEC ~ Aspect+Blue+Catchment_Area+Channel_Network+Elevation+Green+LS_Factor+NDVI+NIR+Rainfall+Red+Slope+SWIR1+SWIR2+Temprature+Valley_Depth+Wetness_Index, data=cov_soil_Train)
vif(mod)
mod <- lm(CEC ~ Aspect+Catchment_Area+Channel_Network+Elevation+Green+LS_Factor+NDVI+NIR+Rainfall+Red+Slope+SWIR1+SWIR2+Temprature+Valley_Depth+Wetness_Index, data=cov_soil_Train)
vif(mod)
mod <- lm(CEC ~ Aspect+Catchment_Area+Elevation+Green+LS_Factor+NDVI+NIR+Rainfall+Red+Slope+SWIR1+SWIR2+Temprature+Valley_Depth+Wetness_Index, data=cov_soil_Train)
vif(mod)
mod <- lm(CEC ~ Aspect+Catchment_Area+Elevation+LS_Factor+NDVI+NIR+Rainfall+Red+Slope+SWIR1+SWIR2+Temprature+Valley_Depth+Wetness_Index, data=cov_soil_Train)
vif(mod)
mod <- lm(CEC ~ Aspect+Catchment_Area+Elevation+LS_Factor+NDVI+NIR+Rainfall+Red+Slope+SWIR2+Temprature+Valley_Depth+Wetness_Index, data=cov_soil_Train)
vif(mod)
mod <- lm(CEC ~ Aspect+Catchment_Area+Elevation+LS_Factor+NDVI+NIR+Rainfall+Slope+SWIR2+Temprature+Valley_Depth+Wetness_Index, data=cov_soil_Train)
vif(mod)
mod <- lm(CEC ~ Aspect+Catchment_Area+Elevation+LS_Factor+NDVI+NIR+Rainfall+Slope+Temprature+Valley_Depth+Wetness_Index, data=cov_soil_Train)
vif(mod)
mod <- lm(CEC ~ Aspect+Catchment_Area+Elevation+LS_Factor+NDVI+NIR+Rainfall+Slope+Valley_Depth+Wetness_Index, data=cov_soil_Train)
vif(mod)
mod <- lm(CEC ~ Aspect+Catchment_Area+LS_Factor+NDVI+NIR+Rainfall+Slope+Valley_Depth+Wetness_Index, data=cov_soil_Train)
vif(mod)
rf_fit <- randomForest(CEC ~ Aspect+Catchment_Area+LS_Factor+NDVI+NIR+Rainfall+Slope+Valley_Depth+Wetness_Index,
data = cov_soil_Train, ntree = 10000) #Cor: 2.1
print(rf_fit)
CEC_rf_Pred <- predict(rf_fit, cov_soil_Test)
# calculate correlation
cor_rf <- cor(cov_soil_Test$CEC, CEC_rf_Pred)
cor_rf
R2_RF <- 1 - sum((cov_soil_Test$CEC - CEC_rf_Pred)^2)/sum((cov_soil_Test$CEC - mean(cov_soil_Test$CEC))^2)
R2_RF
rf_fit <- randomForest(CEC ~ Aspect+Catchment_Area+LS_Factor+NDVI+NIR+Rainfall+Slope+Valley_Depth+Wetness_Index,
data = cov_soil_Train, ntree = 10000) #Cor: 2.1
summary(rf_fit)
print(rf_fit)
rf_fit <- randomForest(CEC ~ Aspect+Catchment_Area+LS_Factor+NDVI+NIR+Rainfall+Slope+Valley_Depth+Wetness_Index,
data = cov_soil_Train, ntree = 10000) #Cor: 2.1
summary(rf_fit)
# variable importance
importance(rf_fit)
varImpPlot(rf_fit, main = "Variable Importance for RF model")
CEC_rf_Pred <- predict(rf_fit, cov_soil_Test)
# check the plot actual and predicted OC values
plot(cov_soil_Test$CEC, CEC_rf_Pred, main="Tree model",
col="blue",xlab="Actual CEC", ylab="Predicted CEC", xlim=c(0,100),ylim=c(0,100))
abline(coef = c(0,1),  col="red" )
# calculate correlation
cor_rf <- cor(cov_soil_Test$CEC, CEC_rf_Pred)
cor_rf
rf_fit <- randomForest(CEC ~ Aspect+LS_Factor+NDVI+NIR+Slope+Wetness_Index,
data = cov_soil_Train, ntree = 10000) #Cor: 2.1
# variable importance
importance(rf_fit)
varImpPlot(rf_fit, main = "Variable Importance for RF model")
CEC_rf_Pred <- predict(rf_fit, cov_soil_Test)
# check the plot actual and predicted OC values
plot(cov_soil_Test$CEC, CEC_rf_Pred, main="Tree model",
col="blue",xlab="Actual CEC", ylab="Predicted CEC", xlim=c(0,100),ylim=c(0,100))
abline(coef = c(0,1),  col="red" )
# calculate correlation
cor_rf <- cor(cov_soil_Test$CEC, CEC_rf_Pred)
cor_rf
rf_fit <- randomForest(CEC ~ Aspect+LS_Factor+NDVI+Slope+Wetness_Index,
data = cov_soil_Train, ntree = 10000) #Cor: 2.1
summary(rf_fit)
# variable importance
importance(rf_fit)
varImpPlot(rf_fit, main = "Variable Importance for RF model")
CEC_rf_Pred <- predict(rf_fit, cov_soil_Test)
# check the plot actual and predicted OC values
plot(cov_soil_Test$CEC, CEC_rf_Pred, main="Tree model",
col="blue",xlab="Actual CEC", ylab="Predicted CEC", xlim=c(0,100),ylim=c(0,100))
abline(coef = c(0,1),  col="red" )
# calculate correlation
cor_rf <- cor(cov_soil_Test$CEC, CEC_rf_Pred)
cor_rf
rf_fit <- randomForest(CEC ~ LS_Factor+NDVI+Wetness_Index,
data = cov_soil_Train, ntree = 10000) #Cor: 2.1
summary(rf_fit)
# variable importance
importance(rf_fit)
varImpPlot(rf_fit, main = "Variable Importance for RF model")
CEC_rf_Pred <- predict(rf_fit, cov_soil_Test)
# check the plot actual and predicted OC values
plot(cov_soil_Test$CEC, CEC_rf_Pred, main="Tree model",
col="blue",xlab="Actual CEC", ylab="Predicted CEC", xlim=c(0,100),ylim=c(0,100))
abline(coef = c(0,1),  col="red" )
# calculate correlation
cor_rf <- cor(cov_soil_Test$CEC, CEC_rf_Pred)
cor_rf
R2_RF <- 1 - sum((cov_soil_Test$CEC - CEC_rf_Pred)^2)/sum((cov_soil_Test$CEC - mean(cov_soil_Test$CEC))^2)
R2_RF
# random forest prediction part
map_rf <- raster::predict(covariates_RS, rf_fit)
# plot the RF map
spplot(map_rf, main = "CEC map based on RF model")
# append residuals
cov_soilA$residuals <- cov_soilA$CEC - rf_fit$predicted
# append residuals
cov_soil$residuals <- cov_soil$CEC - rf_fit$predicted
# append residuals
cov_soil$residuals <- cov_soil$CEC - CEC_rf_fit$predicted
# append residuals
cov_soil$residuals <- cov_soil$CEC - CEC_rf_Pred
names(cov_soil)
summary(cov_soil)
# histogram of the residuals
hist(cov_soilA$residuals, col = "lightblue")
# histogram of the residuals
hist(cov_soil$residuals, col = "lightblue")
# convert cov_soil to spatial data
cov_soil$x <- soil_csv$x
cov_soil$y <- soil_csv$y
coordinates(cov_soil) <- ~ x + y
proj4string(cov_soil) <- CRS("+init=epsg:4326")
# compute experimental semivariogram of residuals
#install.packages(gstat)
library(gstat)
gstat_res <- gstat(formula = residuals ~ 1, data = cov_soilA)
vg_res    <- variogram(gstat_res)
plot(vg_res, plot.nu = FALSE)
# define initial semivariogram model
vg_parameters_res <- vgm(nugget = 70, psill = 100, range = 100, model = "Pen")
# compute experimental semivariogram of residuals
#install.packages(gstat)
library(gstat)
gstat_res <- gstat(formula = residuals ~ 1, data = cov_soilA)
gstat_res <- gstat(formula = residuals ~ 1, data = cov_soil)
vg_res    <- variogram(gstat_res)
plot(vg_res, plot.nu = FALSE)
# define initial semivariogram model
vg_parameters_res <- vgm(nugget = 70, psill = 100, range = 100, model = "Pen")
plot(vg_res, vg_parameters_res)
# fit semivariogram model
vg_model_res <- fit.variogram(vg_res, vg_parameters_res)
plot(vg_res, vg_model_res)
vg_model_res
# export boundary as a grid (approx. 90 m)
res(covariates_RS)
r_template <- raster(study_area, res = 0.00898)                 # template raster
r_mask     <- rasterize(study_area, r_template, field = 1) # inside polygon = 1, outside = NA
study_area_grid <- as(r_mask, "SpatialPixelsDataFrame")    # grid for kriging
# ordinary kriging of residuals
res_krig <- krige(
formula   = residuals ~ 1,
locations = cov_soilA,
newdata   = study_area_grid,
model     = vg_model_res
)
# ordinary kriging of residuals
res_krig <- krige(
formula   = residuals ~ 1,
locations = cov_soil,
newdata   = study_area_grid,
model     = vg_model_res
)
# plot the residuals map
spplot(res_krig, zcol = "var1.pred", main = "residuals predictions")
# obtain regression kriging prediction
res_krig_raster <- raster::resample(raster(res_krig), map_rf)
RK_map <-     res_krig_raster +  map_rf ##evtl. umdrehen!?
# rk performance
RK_pred <- extract(RK_map, cov_soilA)
# rk performance
RK_pred <- extract(RK_map, cov_soil)
RMSE_RK <- sqrt(mean((cov_soil$CEC - RK_pred)^2))
RMSE_RK
MAE_RK <- mean(abs(cov_soil$CEC - RK_pred))
MAE_RK
R2_RK <- 1 - sum((cov_soil$CEC - RK_pred)^2) / sum((cov_soil$CEC - mean(cov_soil$CEC))^2)
R2_RK
# plot the RK map
spplot(RK_map, main = "CEC map based on RK model")
# plot the residuals map
dev.off()
par(mfrow=c(1,2))
spplot(res_krig, zcol = "var1.pred", main = "residuals predictions")
spplot(map_rf, main = "CEC map based on RF model")
spplot(res_krig, zcol = "var1.pred", main = "residuals predictions")
# plot the RK map
dev.off()
par(mfrow=c(1,2))
spplot(RK_map, main = "CEC map based on RK model")
spplot(map_rf, main = "CEC map based on RF model")
par(mfrow=c(,2))
spplot(RK_map, main = "CEC map based on RK model")
spplot(map_rf, main = "CEC map based on RF model")
# plot the RK map
spplot(map_rf, main = "CEC map based on RF model")
spplot(RK_map, main = "CEC map based on RK model")
# plot the RK map
spplot(map_rf, main = "CEC map based on RF model")
spplot(RK_map, main = "CEC map based on RK model")
