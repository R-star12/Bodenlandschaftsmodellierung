write.csv(df, "./GIS/punkte.csv", row.names = FALSE)
View(df)
points_csv <- read.csv("./GIS/punkte.csv", header = TRUE)
View(points_csv)
coordinates(points_csv) <- ~ X + Y
proj4string(points_csv) <- CRS("+init=epsg:4326")
View(points_csv)
plot(points_csv, pch = 19)
# Covariablen laden und benennen (automatische Benennung hat bei mir iwie nicht geklappt)
covariates_RS <- stack(list.files("./Covariates/", pattern="\\.tif$", full.names = TRUE))
names(covariates_RS) <- c("Aspect", "Blue", "Catchment_Area", "Channel_Network", "Elevation", "Green", "LS_Factor", "NDVI",
"NIR", "Rainfall", "Red", "Slope", "SWIR1", "SWIR2", "Temperature", "Valley_Depth", "Wetness_Index")
names(covariates_RS)
crs(covariates_RS) <- "EPSG:4326"
head(points_csv)
boundary = st_read("./GIS/boundary.shp")
plot(boundary)
plot(study_area)
study_area_sf <- st_read("./GIS/boundary.shp")
study_area    <- as(study_area_sf, "Spatial")
plot(study_area)
study_area <- as(st_read("./GIS/boundary.shp"), "Spatial")
plot(study_area)
plot(points_csv, add =T, pch = 19)
View(points_csv)
# Import der .csv SOIL Daten & Umwandlung in räumliche Daten (Koordinaten + Koordinatensystem)
soil_csv <- read.csv("./Soil/soil.csv", header = TRUE)
coordinates(soil_csv) <- ~ x + y
proj4string(soil_csv) <- CRS("+init=epsg:4326")
head(soil_csv)
plot(soil_csv, add =T, pch = 18)
plot(soil_csv, add =T, pch = 18, col ="red")
# empty workspace
rm(list = ls())
# check directory
getwd()
# loading libraries
library(sp)
library(raster)
library(sf)
library(caret)
library(randomForest)
library (ggplot2)
# Kovariablen laden, benennen (automatische Benennung hat nicht geklappt) & Koordinatensystem zuweisen
covariates_RS <- stack(list.files("./Covariates/", pattern="\\.tif$", full.names = TRUE))
names(covariates_RS) <- c("Aspect", "Blue", "Catchment_Area", "Channel_Network", "Elevation", "Green", "LS_Factor", "NDVI",
"NIR", "Rainfall", "Red", "Slope", "SWIR1", "SWIR2", "Temperature", "Valley_Depth", "Wetness_Index")
crs(covariates_RS) <- "EPSG:4326"
# Import der .csv SOIL Daten & Umwandlung in räumliche Daten (Koordinaten + Koordinatensystem)
soil_csv <- read.csv("./Soil/soil.csv", header = TRUE)
coordinates(soil_csv) <- ~ x + y
proj4string(soil_csv) <- CRS("+init=epsg:4326")
head(soil_csv)
plot(soil_csv, add =T, pch = 18, col ="red")
# Import der Grenzen des Untersuchungsgebiets
study_area <- as(st_read("./GIS/boundary.shp"), "Spatial")
plot(study_area)
plot(soil_csv, add =T, pch = 18, col ="red")
View(soil_csv)
View(covariates_RS)
# extract covariate values at each point of observation
cov = extract(covariates_RS, soil_csv, method='bilinear', df=TRUE)
View(cov)
View(soil_csv)
# combining covariates and soil properties
cov_soil = cbind(cov[,-1], CEC=soil_csv$CEC)
View(cov_soil)
# remove na values
cov_soil <- cov_soil[complete.cases(cov_soil),]
str(cov_soil)
# empty workspace
rm(list = ls())
# check directory
getwd()
# loading libraries
library(sp)
library(raster)
library(sf)
library(caret)
library(randomForest)
library (ggplot2)
# Kovariablen laden, benennen (automatische Benennung hat nicht geklappt) & Koordinatensystem zuweisen
covariates_RS <- stack(list.files("./Covariates/", pattern="\\.tif$", full.names = TRUE))
names(covariates_RS) <- c("Aspect", "Blue", "Catchment_Area", "Channel_Network", "Elevation", "Green", "LS_Factor", "NDVI",
"NIR", "Rainfall", "Red", "Slope", "SWIR1", "SWIR2", "Temperature", "Valley_Depth", "Wetness_Index")
crs(covariates_RS) <- "EPSG:4326"
# Import der .csv SOIL Daten & Umwandlung in räumliche Daten (Koordinaten + Koordinatensystem)
soil_csv <- read.csv("./Soil/soil.csv", header = TRUE)
coordinates(soil_csv) <- ~ x + y
proj4string(soil_csv) <- CRS("+init=epsg:4326")
head(soil_csv)
# Import der Grenzen des Untersuchungsgebiets
study_area <- as(st_read("./GIS/boundary.shp"), "Spatial")
plot(study_area)
# Import der .csv SOIL Daten & Umwandlung in räumliche Daten (Koordinaten + Koordinatensystem)
soil_csv <- read.csv("./Soil/soil.csv", header = TRUE)
coordinates(soil_csv) <- ~ x + y
proj4string(soil_csv) <- CRS("+init=epsg:4326")
head(soil_csv)
plot(soil_csv, add =T, pch = 18, col ="red")
# Extraktion der Kovariaten an den Messpunkten
cov = extract(covariates_RS, soil_csv, method='bilinear', df=TRUE)
# Kombination der Kovariate mit der CEC (Zielvariable)
cov_soil = cbind(cov[,-1], CEC=soil_csv$CEC)
str(cov_soil)
View(cov_soil)
plot(study_area, head = "Untersuchungsgebiet")
plot(study_area, main = "Untersuchungsgebiet")
plot(soil_csv, add =T, pch = 18, col ="red")
str(cov_soil)
# empty workspace
rm(list = ls())
# check directory
getwd()
# loading libraries
library(sp)
library(raster)
library(sf)
library(caret)
library(randomForest)
library (ggplot2)
# Kovariablen laden, benennen (automatische Benennung hat nicht geklappt) & Koordinatensystem zuweisen
covariates_RS <- stack(list.files("./Covariates/", pattern="\\.tif$", full.names = TRUE))
names(covariates_RS) <- c("Aspect", "Blue", "Catchment_Area", "Channel_Network", "Elevation", "Green", "LS_Factor", "NDVI",
"NIR", "Rainfall", "Red", "Slope", "SWIR1", "SWIR2", "Temperature", "Valley_Depth", "Wetness_Index")
crs(covariates_RS) <- "EPSG:4326"
# Import der Grenzen des Untersuchungsgebiets
study_area <- as(st_read("./GIS/boundary.shp"), "Spatial")
plot(study_area, main = "Untersuchungsgebiet")
# Import der .csv SOIL Daten & Umwandlung in räumliche Daten (Koordinaten + Koordinatensystem)
soil_csv <- read.csv("./Soil/soil.csv", header = TRUE)
coordinates(soil_csv) <- ~ x + y
proj4string(soil_csv) <- CRS("+init=epsg:4326")
head(soil_csv)
plot(soil_csv, add =T, pch = 18, col ="red")
# Extraktion der Kovariaten an den Messpunkten
cov = extract(covariates_RS, soil_csv, method='bilinear', df=TRUE)
# Kombination der Kovariate mit der CEC (Zielvariable)
cov_soil = cbind(cov[,-1], CEC=soil_csv$CEC)
###################################################
# empty workspace
rm(list = ls())
# check directory
getwd()
# loading libraries
library(sp)
library(raster)
library(sf)
library(caret)
library(randomForest)
library (ggplot2)
########################### DATA PREPROCESSING ###############################
# Kovariablen laden, benennen (automatische Benennung hat nicht geklappt) & Koordinatensystem zuweisen
covariates_RS <- stack(list.files("./Covariates/", pattern="\\.tif$", full.names = TRUE))
names(covariates_RS) <- c("Aspect", "Blue", "Catchment_Area", "Channel_Network", "Elevation", "Green", "LS_Factor", "NDVI",
"NIR", "Rainfall", "Red", "Slope", "SWIR1", "SWIR2", "Temperature", "Valley_Depth", "Wetness_Index")
crs(covariates_RS) <- "EPSG:4326"
# Import der Grenzen des Untersuchungsgebiets
study_area <- as(st_read("./GIS/boundary.shp"), "Spatial")
plot(study_area, main = "Untersuchungsgebiet")
# Import der .csv SOIL Daten & Umwandlung in räumliche Daten (Koordinaten + Koordinatensystem)
soil_csv <- read.csv("./Soil/soil.csv", header = TRUE)
coordinates(soil_csv) <- ~ x + y
proj4string(soil_csv) <- CRS("+init=epsg:4326")
head(soil_csv)
plot(soil_csv, add =T, pch = 18, col ="red")
# Extraktion der Kovariaten an den Messpunkten
cov = extract(covariates_RS, soil_csv, method='bilinear', df=TRUE)
# Kombination der Kovariate mit der CEC (Zielvariable)
cov_soil = cbind(cov[,-1], CEC=soil_csv$CEC)
str(cov_soil)
# check the correlation between EC and covariates
ggcorrplot(cor(cov_soil), hc.order = TRUE, type = "lower", lab = TRUE)
#Random Forest mit Regression Kriging #EMIL
library(ggcorrplot)
install.packages("ggcorrplot")
#Random Forest mit Regression Kriging #EMIL
library(ggcorrplot)
# check the correlation between EC and covariates
ggcorrplot(cor(cov_soil), hc.order = TRUE, type = "lower", lab = TRUE)
# fit random forest model
rf_fit <- randomForest(CEC ~ ., data = cov_soil, ntree = 1000)
# append residuals
cov_soil$residuals <- cov_soil$CEC - rf_fit$predicted
names(cov_soil)
summary(cov_soil)
# histogram of the residuals
hist(cov_soil$residuals, col = "lightblue")
View(soil_csv)
# empty workspace
rm(list = ls())
# check directory
getwd()
# loading libraries
library(sp)
library(raster)
library(sf)
library(caret)
library(randomForest)
library (ggplot2)
########################### DATA PREPROCESSING ###############################
# Kovariablen laden, benennen (automatische Benennung hat nicht geklappt) & Koordinatensystem zuweisen
covariates_RS <- stack(list.files("./Covariates/", pattern="\\.tif$", full.names = TRUE))
names(covariates_RS) <- c("Aspect", "Blue", "Catchment_Area", "Channel_Network", "Elevation", "Green", "LS_Factor", "NDVI",
"NIR", "Rainfall", "Red", "Slope", "SWIR1", "SWIR2", "Temperature", "Valley_Depth", "Wetness_Index")
crs(covariates_RS) <- "EPSG:4326"
# Import der Grenzen des Untersuchungsgebiets
study_area <- as(st_read("./GIS/boundary.shp"), "Spatial")
plot(study_area, main = "Untersuchungsgebiet")
# Import der .csv SOIL Daten & Umwandlung in räumliche Daten (Koordinaten + Koordinatensystem)
soil_csv <- read.csv("./Soil/soil.csv", header = TRUE)
coordinates(soil_csv) <- ~ x + y
proj4string(soil_csv) <- CRS("+init=epsg:4326")
head(soil_csv)
plot(soil_csv, add =T, pch = 18, col ="red")
# Extraktion der Kovariaten an den Messpunkten
cov = extract(covariates_RS, soil_csv, method='bilinear', df=TRUE)
# Kombination der Kovariate mit der CEC (Zielvariable)
cov_soil = cbind(cov[,-1], CEC=soil_csv$CEC)
str(cov_soil)
###################### DESCRIPTIVE STATISTICS ############################### #ANNALENA
plot(cov_soil$CEC, cov_soil$NDVI)
plot(cov_soil$CEC)
hist(cov_soil$CEC)
plot(cov_soil$CEC, cov_soil$Elevation)
plot(cov_soil$Temperature)
## Korrelationsanalyse
library(ggcorrplot)
# check the correlation between EC and covariates
ggcorrplot(cor(cov_soil), hc.order = TRUE, type = "lower", lab = TRUE)
## Histogramme
####################### MODEL ########################################
#Lineare Regression # ANNALENA
#Random Forest mit Regression Kriging #EMIL
# fit random forest model
rf_fit <- randomForest(CEC ~ ., data = cov_soil, ntree = 1000)
View(rf_fit)
# append residuals
cov_soilA$residuals <- cov_soilA$CEC - rf_fit$predicted
cov_soilA <- cov_soil
rf_fit <- randomForest(CEC ~ ., data = cov_soilA, ntree = 1000)
# append residuals
cov_soilA$residuals <- cov_soilA$CEC - rf_fit$predicted
names(cov_soilA)
summary(cov_soilA)
rf_fit <- randomForest(CEC ~ ., data = cov_soilA, ntree = 1000)
View(soil_csv)
# convert cov_soil to spatial data
cov_soilA$x <- soil_csv.df$x
# convert cov_soil to spatial data
cov_soilA$x <- soil_csv$x
cov_soilA$y <- soil_csv$y
View(cov_soilA)
coordinates(cov_soilA) <- ~ x + y
proj4string(cov_soilA) <- CRS("+proj=utm +zone=39 +datum=WGS84 +units=m +no_defs")
spplot(cov_soilA)
# compute experimental semivariogram of residuals
gstat_res <- gstat(formula = residuals ~ 1, data = cov_soilA)
# compute experimental semivariogram of residuals
library(gstat)
gstat_res <- gstat(formula = residuals ~ 1, data = cov_soilA)
vg_res    <- variogram(gstat_res)
plot(vg_res, plot.nu = FALSE)
# define initial semivariogram model
vg_parameters_res <- vgm(nugget = 40, psill = 500, range = 1,5, model = "Gau")
# define initial semivariogram model
vg_parameters_res <- vgm(nugget = 40, psill = 50, range = 1,5, model = "Gau")
# define initial semivariogram model
vg_parameters_res <- vgm(nugget = 40, psill = 50, range = 1.5, model = "Gau")
plot(vg_res, vg_parameters_res)
# define initial semivariogram model
vg_parameters_res <- vgm(nugget = 40, psill = 500, range = 1.5, model = "Gau")
plot(vg_res, vg_parameters_res)
?vg_parameters_res
??vg_parameters_res
?vgm()
# define initial semivariogram model
vg_parameters_res <- vgm(nugget = 70, psill = 00, range = 1.5, model = "")
plot(vg_res, vg_parameters_res)
# define initial semivariogram model
vg_parameters_res <- vgm(nugget = 70, psill = 100, range = 1.5, model = "Cir")
plot(vg_res, vg_parameters_res)
# fit semivariogram model
vg_model_res <- fit.variogram(vg_res, vg_parameters_res)
plot(vg_res, vg_model_res)
vg_model_res
# define initial semivariogram model
vg_parameters_res <- vgm(nugget = 70, psill = 100, range = 1, model = "Cir")
plot(vg_res, vg_parameters_res)
# fit semivariogram model
vg_model_res <- fit.variogram(vg_res, vg_parameters_res)
plot(vg_res, vg_model_res)
vg_model_res
# define initial semivariogram model
vg_parameters_res <- vgm(nugget = 70, psill = 150, range = 1, model = "Cir")
plot(vg_res, vg_parameters_res)
# fit semivariogram model
vg_model_res <- fit.variogram(vg_res, vg_parameters_res)
plot(vg_res, vg_model_res)
# define initial semivariogram model
vg_parameters_res <- vgm(nugget = 70, psill = 100, range = 1, model = "Mat")
plot(vg_res, vg_parameters_res)
# define initial semivariogram model
vg_parameters_res <- vgm(nugget = 70, psill = 100, range = 1, model = "Exp")
plot(vg_res, vg_parameters_res)
# fit semivariogram model
vg_model_res <- fit.variogram(vg_res, vg_parameters_res)
plot(vg_res, vg_model_res)
vg_model_res
Exp
Exp
# define initial semivariogram model
vg_parameters_res <- vgm(nugget = 70, psill = 100, range = 1, model = "Exp")
plot(vg_res, vg_parameters_res)
# fit semivariogram model
vg_model_res <- fit.variogram(vg_res, vg_parameters_res)
plot(vg_res, vg_model_res)
# define initial semivariogram model
vg_parameters_res <- vgm(nugget = 70, psill = 100, range = 1, model = "Bes")
plot(vg_res, vg_parameters_res)
# fit semivariogram model
vg_model_res <- fit.variogram(vg_res, vg_parameters_res)
plot(vg_res, vg_model_res)
vg_model_res
# define initial semivariogram model
vg_parameters_res <- vgm(nugget = 70, psill = 100, range = 1, model = "Pen")
plot(vg_res, vg_parameters_res)
# fit semivariogram model
vg_model_res <- fit.variogram(vg_res, vg_parameters_res)
plot(vg_res, vg_model_res)
vg_model_res
# define initial semivariogram model
vg_parameters_res <- vgm(nugget = 70, psill = 100, range = 1.5, model = "Pen")
plot(vg_res, vg_parameters_res)
# fit semivariogram model
vg_model_res <- fit.variogram(vg_res, vg_parameters_res)
plot(vg_res, vg_model_res)
vg_model_res
# define initial semivariogram model
vg_parameters_res <- vgm(nugget = 70, psill = 100, range = 1.5, model = "Gau")
plot(vg_res, vg_parameters_res)
# fit semivariogram model
vg_model_res <- fit.variogram(vg_res, vg_parameters_res)
plot(vg_res, vg_model_res)
vg_model_res
# define initial semivariogram model
vg_parameters_res <- vgm(nugget = 70, psill = 100, range = 1.5, model = "Sph")
plot(vg_res, vg_parameters_res)
# fit semivariogram model
vg_model_res <- fit.variogram(vg_res, vg_parameters_res)
plot(vg_res, vg_model_res)
# define initial semivariogram model
vg_parameters_res <- vgm(nugget = 70, psill = 100, range = 1.5, model = "Cir")
plot(vg_res, vg_parameters_res)
# fit semivariogram model
vg_model_res <- fit.variogram(vg_res, vg_parameters_res)
plot(vg_res, vg_model_res)
# define initial semivariogram model
vg_parameters_res <- vgm(nugget = 70, psill = 100, range = 1.5, model = "Pen")
plot(vg_res, vg_parameters_res)
# fit semivariogram model
vg_model_res <- fit.variogram(vg_res, vg_parameters_res)
plot(vg_res, vg_model_res)
vg_model_res
# export boundary as a grid (approx. 90 m)
res(covariates_RS)
r_template <- raster(study_area, res = 1000)                 # template raster
r_mask     <- rasterize(study_area, r_template, field = 1) # inside polygon = 1, outside = NA
study_area_grid <- as(r_mask, "SpatialPixelsDataFrame")    # grid for kriging
# define initial semivariogram model
vg_parameters_res <- vgm(nugget = 70, psill = 100, range = 1.5, model = "Pen")
# define initial semivariogram model
vg_parameters_res <- vgm(nugget = 70, psill = 100, range = 1.5, model = "Pen")
plot(vg_res, vg_parameters_res)
# fit semivariogram model
vg_model_res <- fit.variogram(vg_res, vg_parameters_res)
plot(vg_res, vg_model_res)
# export boundary as a grid (approx. 90 m)
res(covariates_RS) #Rastergröße etwa 1 km + 1 km
r_template <- raster(study_area, res = 0.009)                 # template raster
r_mask     <- rasterize(study_area, r_template, field = 1) # inside polygon = 1, outside = NA
study_area_grid <- as(r_mask, "SpatialPixelsDataFrame")    # grid for kriging
# ordinary kriging of residuals
res_krig <- krige(
formula   = residuals ~ 1,
locations = cov_soilA,
newdata   = study_area_grid,
model     = vg_model_res
)
crs(cov_soilA)
crs(cov_soilA) <- "EPSG:4326"
crs(cov_soilA) <- "EPSG:4326"
crs(cov_soilA)
# ordinary kriging of residuals
res_krig <- krige(
formula   = residuals ~ 1,
locations = cov_soilA,
newdata   = study_area_grid,
model     = vg_model_res
)
# plot the residuals map
spplot(res_krig, zcol = "var1.pred", main = "residuals predictions")
# plot the residuals map
spplot(res_krig, zcol = "var1.pred", main = "residuals predictions")
# random forest prediction part
map_rf <- raster::predict(covariates_RS, rf_fit)
# random forest prediction part
map_rf <- raster::predict(covariates, rf_fit)
View(covariates_RS)
View(rf_fit)
View(covariates_RS)
# random forest prediction part
map_rf <- raster::predict(covariates_RS, rf_fit)
rm(list = ls())
# check directory
getwd()
# loading libraries
library(sp)
library(raster)
library(sf)
library(caret)
library(randomForest)
library (ggplot2)
########################### DATA PREPROCESSING ###############################
# Kovariablen laden, benennen (automatische Benennung hat nicht geklappt) & Koordinatensystem zuweisen
covariates_RS <- stack(list.files("./Covariates/", pattern="\\.tif$", full.names = TRUE))
names(covariates_RS) <- c("Aspect", "Blue", "Catchment_Area", "Channel_Network", "Elevation", "Green", "LS_Factor", "NDVI",
"NIR", "Rainfall", "Red", "Slope", "SWIR1", "SWIR2", "Temperature", "Valley_Depth", "Wetness_Index")
crs(covariates_RS) <- "EPSG:4326"
# Import der Grenzen des Untersuchungsgebiets
study_area <- as(st_read("./GIS/boundary.shp"), "Spatial")
plot(study_area, main = "Untersuchungsgebiet")
# Import der .csv SOIL Daten & Umwandlung in räumliche Daten (Koordinaten + Koordinatensystem)
soil_csv <- read.csv("./Soil/soil.csv", header = TRUE)
coordinates(soil_csv) <- ~ x + y
proj4string(soil_csv) <- CRS("+init=epsg:4326")
head(soil_csv)
plot(soil_csv, add =T, pch = 18, col ="red")
# Extraktion der Kovariaten an den Messpunkten
cov = extract(covariates_RS, soil_csv, method='bilinear', df=TRUE)
# Kombination der Kovariate mit der CEC (Zielvariable)
cov_soil = cbind(cov[,-1], CEC=soil_csv$CEC)
str(cov_soil)
###################### DESCRIPTIVE STATISTICS ############################### #ANNALENA
plot(cov_soil$CEC, cov_soil$NDVI)
plot(cov_soil$CEC)
hist(cov_soil$CEC)
plot(cov_soil$CEC, cov_soil$Elevation)
plot(cov_soil$Temperature)
## Korrelationsanalyse
library(ggcorrplot)
# check the correlation between EC and covariates
ggcorrplot(cor(cov_soil), hc.order = TRUE, type = "lower", lab = TRUE)
## Histogramme
####################### MODEL ########################################
#Lineare Regression # ANNALENA
#Random Forest mit Regression Kriging #EMIL
# Erstellen eines neuen Datensatzes zum üben
cov_soilA <- cov_soil
rf_fit <- randomForest(CEC ~ ., data = cov_soilA, ntree = 1000)
# random forest prediction part
map_rf <- raster::predict(covariates_RS, rf_fit)
# plot the RF map
spplot(map_rf, main = "EC map based on RF model")
# append residuals
cov_soilA$residuals <- cov_soilA$CEC - rf_fit$predicted
names(cov_soilA)
summary(cov_soilA)
# histogram of the residuals
hist(cov_soilA$residuals, col = "lightblue")
# convert cov_soil to spatial data
cov_soilA$x <- soil_csv$x
cov_soilA$y <- soil_csv$y
coordinates(cov_soilA) <- ~ x + y
proj4string(cov_soilA) <- CRS("+proj=utm +zone=39 +datum=WGS84 +units=m +no_defs")
spplot(cov_soilA)
# compute experimental semivariogram of residuals
library(gstat)
gstat_res <- gstat(formula = residuals ~ 1, data = cov_soilA)
vg_res    <- variogram(gstat_res)
plot(vg_res, plot.nu = FALSE)
# define initial semivariogram model
vg_parameters_res <- vgm(nugget = 70, psill = 100, range = 1.5, model = "Pen")
plot(vg_res, vg_parameters_res)
# fit semivariogram model
vg_model_res <- fit.variogram(vg_res, vg_parameters_res)
plot(vg_res, vg_model_res)
vg_model_res
# export boundary as a grid (approx. 90 m)
res(covariates_RS) #Rastergröße etwa 1 km + 1 km
r_template <- raster(study_area, res = 0.009)                 # template raster
r_mask     <- rasterize(study_area, r_template, field = 1) # inside polygon = 1, outside = NA
study_area_grid <- as(r_mask, "SpatialPixelsDataFrame")    # grid for kriging
crs(cov_soilA) <- "EPSG:4326"
# ordinary kriging of residuals
res_krig <- krige(
formula   = residuals ~ 1,
locations = cov_soilA,
newdata   = study_area_grid,
model     = vg_model_res
)
# plot the residuals map
spplot(res_krig, zcol = "var1.pred", main = "residuals predictions")
# obtain regression kriging prediction
res_krig_raster <- raster::resample(raster(res_krig), map_rf)
RK_map <-     res_krig_raster +  map_rf
# plot the RK map
spplot(RK_map, main = "EC map based on RK model")
# plot the residuals map
spplot(res_krig, zcol = "var1.pred", main = "residuals predictions")
# plot the RK map
spplot(RK_map, main = "CEC map based on RK model")
